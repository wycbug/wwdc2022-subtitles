1
00:00:00,501 --> 00:00:08,509
♪ ♪

2
00:00:10,010 --> 00:00:11,912
Karthik: 大家好 我是 Karthik

3
00:00:11,945 --> 00:00:14,581
是信息团队的一名工程师

4
00:00:14,615 --> 00:00:18,318
在本视频中
我将向大家介绍“与您共享”

5
00:00:18,352 --> 00:00:20,921
以及如何在您的 App 中使用它

6
00:00:22,523 --> 00:00:25,959
“与您共享”
是在 iOS 15 中发布的

7
00:00:25,993 --> 00:00:29,830
其设计目的是让用户更容易重新访问

8
00:00:29,863 --> 00:00:33,667
朋友和家人在“信息”中
发送的链接

9
00:00:33,700 --> 00:00:37,604
可使用“与您共享”的
系统 App 包括

10
00:00:37,638 --> 00:00:40,240
Safari 浏览器、新闻、

11
00:00:40,274 --> 00:00:42,910
音乐、播客、

12
00:00:42,943 --> 00:00:46,213
Apple TV 以及照片 App

13
00:00:46,246 --> 00:00:51,351
“与您共享”也可以用于浏览内容

14
00:00:51,385 --> 00:00:56,390
很多时候 在我们准备好浏览之前
就已经收到了内容

15
00:00:56,423 --> 00:01:01,028
例如 当您外出购物时

16
00:01:01,061 --> 00:01:03,630
一个朋友向您推荐了一个电视节目

17
00:01:03,664 --> 00:01:07,901
然后您忙了一天就忘记了

18
00:01:07,935 --> 00:01:12,840
但当您在 TV App 中浏览
要观看的电视节目时

19
00:01:12,873 --> 00:01:17,477
“与您共享”就可以帮您
更容易地找到这个节目

20
00:01:17,511 --> 00:01:22,816
“与您共享”
可以方便地从 App 中

21
00:01:22,850 --> 00:01:25,252
获取信息对话

22
00:01:25,285 --> 00:01:29,456
让您无需离开 App

23
00:01:29,489 --> 00:01:31,792
就能了解共享的内容

24
00:01:33,594 --> 00:01:36,964
您的内容可以
在“信息”中被置顶

25
00:01:36,997 --> 00:01:42,436
这样内容就会在
“与您共享”和搜索中提前

26
00:01:42,469 --> 00:01:45,405
这是一个表示内容很重要的信号

27
00:01:45,439 --> 00:01:48,809
并会启动自动共享同意流程

28
00:01:48,842 --> 00:01:51,211
稍后我们将详细介绍这一点

29
00:01:51,245 --> 00:01:57,618
在 iOS 16 中“与您共享”还能包含
您的 App 链接和内容

30
00:01:57,651 --> 00:02:01,822
这样一来“与您共享”
就让您的 App 更方便高效

31
00:02:03,023 --> 00:02:06,927
我先介绍一下您的 App 中
“与您共享”的设计

32
00:02:06,960 --> 00:02:09,997
然后再演示它的工作原理

33
00:02:10,030 --> 00:02:13,066
接着 我会带您了解
如何使用“与您共享”

34
00:02:14,401 --> 00:02:16,203
我们先从设计开始

35
00:02:16,236 --> 00:02:21,208
您将会体验到
“与您共享”的两个部分

36
00:02:21,241 --> 00:02:26,013
“与您共享”工具架
和“与您共享”属性视图

37
00:02:26,046 --> 00:02:29,516
“与您共享”工具架是
App 浏览体验中的

38
00:02:29,550 --> 00:02:32,386
一个专用空间

39
00:02:32,419 --> 00:02:37,090
用于突出显示消息中共享的内容

40
00:02:37,124 --> 00:02:44,198
例如 TV App 的“立即观看”标签页
有一个“与您共享”工具架

41
00:02:44,231 --> 00:02:48,502
音乐和播客中的
“现在就听”标签也是如此

42
00:02:49,937 --> 00:02:55,475
“与您共享”提供的内容
是经过排名和排序的列表

43
00:02:55,509 --> 00:02:58,879
稍后我会在视频中介绍这一点

44
00:02:58,912 --> 00:03:01,949
“与您共享”工具架中的每个项目

45
00:03:01,982 --> 00:03:07,087
都具有丰富的预览和属性视图

46
00:03:07,120 --> 00:03:11,391
预览包含缩略图、标题、

47
00:03:11,425 --> 00:03:14,361
和副标题 (如有)

48
00:03:14,394 --> 00:03:19,166
在本例中
丰富的预览效果包括了播客图片、

49
00:03:19,199 --> 00:03:22,669
剧集名称和节目名称

50
00:03:22,703 --> 00:03:27,341
“与您共享”工具架中的
每个共享内容

51
00:03:27,374 --> 00:03:29,610
还有一个属性视图

52
00:03:29,643 --> 00:03:33,479
它会提供足量信息
让内容的对应情景

53
00:03:33,513 --> 00:03:34,681
一目了然

54
00:03:36,083 --> 00:03:39,486
有一个 Show More 元素
可以扩展视图或导航

55
00:03:39,520 --> 00:03:44,024
来显示您 App 中的
所有“与您共享”内容

56
00:03:44,057 --> 00:03:47,794
属性视图是一个进程外视图

57
00:03:47,828 --> 00:03:54,434
它将安全地显示分享者的姓名和头像

58
00:03:54,468 --> 00:03:59,907
它还会显示内容是否
在“信息”中被置顶

59
00:03:59,940 --> 00:04:05,012
在内容的详细信息视图中
显示属性视图

60
00:04:05,045 --> 00:04:09,216
这将允许用户将您 App 中的内容

61
00:04:09,249 --> 00:04:12,886
连接回其共享的“信息”对话中

62
00:04:12,920 --> 00:04:17,124
例如 当我浏览电视节目时

63
00:04:17,157 --> 00:04:23,497
属性视图可以帮助我回忆起
某位朋友推荐的节目

64
00:04:23,530 --> 00:04:28,202
因此我可以方便地告诉这位朋友
我就要看这个节目了

65
00:04:28,235 --> 00:04:31,872
所有这些操作都能
在 App 中完成

66
00:04:31,905 --> 00:04:36,376
回复后 我马上就能观看节目

67
00:04:36,410 --> 00:04:39,179
属性视图是交互式的

68
00:04:39,213 --> 00:04:42,482
点击视图可以直接从 App 内部

69
00:04:42,516 --> 00:04:45,185
接入“信息”对话

70
00:04:45,219 --> 00:04:50,123
属性视图还提供上下文菜单选项

71
00:04:50,157 --> 00:04:53,994
如回复和移除

72
00:04:54,027 --> 00:05:00,968
回复内容菜单选项的功能
类似于点击视图

73
00:05:01,001 --> 00:05:04,638
而“移除”上下文菜单选项
则能让“与您共享”

74
00:05:04,671 --> 00:05:08,509
停止继续显示内容

75
00:05:08,542 --> 00:05:12,346
您可以将相同的上下文菜单

76
00:05:12,379 --> 00:05:16,717
添加到内容的上下文菜单中

77
00:05:16,750 --> 00:05:21,488
您也可以自定义
“移除”上下文菜单的标题

78
00:05:21,522 --> 00:05:24,358
例如 在 Safari 浏览器中

79
00:05:24,391 --> 00:05:29,396
网页的上下文菜单会显示"Remove Link"

80
00:05:29,429 --> 00:05:35,269
我将在稍后的视频中介绍
如何在您的 App 中执行此操作

81
00:05:35,302 --> 00:05:38,872
现在 您已经了解在哪里展示
“与您共享”工具架

82
00:05:38,906 --> 00:05:42,242
以及在哪里显示属性视图

83
00:05:42,276 --> 00:05:45,045
现在我将向您演示
“与您共享”的工作原理

84
00:05:45,078 --> 00:05:52,386
朋友和家人在“信息”中共享的链接
会显示在“与您共享”中

85
00:05:52,419 --> 00:05:55,589
当至少有一个参与者是联系人时

86
00:05:55,622 --> 00:05:59,826
群组聊天的链接就会出现

87
00:05:59,860 --> 00:06:05,332
“与您共享”是基于
通用链接背后的相同技术

88
00:06:05,365 --> 00:06:11,505
通用链接
可以无缝链接到您的 App

89
00:06:11,538 --> 00:06:14,208
或网站上的内容

90
00:06:14,241 --> 00:06:19,346
用户可以精确控制
“与您共享”的内容

91
00:06:20,414 --> 00:06:25,118
他们可以选择在每个会话

92
00:06:25,152 --> 00:06:27,988
每个 App 或全球范围内

93
00:06:28,021 --> 00:06:31,124
共享“信息”之外的内容

94
00:06:31,158 --> 00:06:36,396
无需提前请求此权限

95
00:06:36,430 --> 00:06:39,399
这是自然发生的

96
00:06:39,433 --> 00:06:46,340
置顶链接是在“与您共享”中
显示内容的隐含权限

97
00:06:46,373 --> 00:06:52,012
置顶内容可始终显示在
App 中的“与您共享”中

98
00:06:52,045 --> 00:06:57,951
当 App 内容在“信息”中置顶时
基于启发式方法

99
00:06:57,985 --> 00:07:03,123
会出现一个启用自动共享的选项

100
00:07:03,156 --> 00:07:06,527
启动自动共享后

101
00:07:06,560 --> 00:07:12,299
App 中的“与您共享”
将显示更多内容

102
00:07:13,834 --> 00:07:17,304
“与您共享”中的内容已调用

103
00:07:17,337 --> 00:07:22,910
“与您共享”工具架上的
第一个项目是由 Siri 建议

104
00:07:22,943 --> 00:07:26,914
根据系统的各种信号整理的

105
00:07:26,947 --> 00:07:30,751
接下来是置顶项目

106
00:07:30,784 --> 00:07:34,788
列表的其余部分按时间顺序排列

107
00:07:36,790 --> 00:07:40,661
Siri 建议使用的信号包括
用户是否看过内容

108
00:07:40,694 --> 00:07:43,130
或与内容进行了互动

109
00:07:43,163 --> 00:07:45,032
内容是否被置顶

110
00:07:45,065 --> 00:07:48,902
内容在何种情境中呈现

111
00:07:48,936 --> 00:07:52,539
您的 App 在提供此反馈方面
发挥了一定作用

112
00:07:52,573 --> 00:07:56,443
稍后我将在视频中详细介绍

113
00:07:56,476 --> 00:08:02,649
所有这些都是为了确保内容
不会过于短暂或过时

114
00:08:02,683 --> 00:08:07,521
在多次共享链接的会话中

115
00:08:07,554 --> 00:08:12,726
“与您共享”只显示最新的消息

116
00:08:12,759 --> 00:08:17,331
当链接在多条“信息”对话中共享时

117
00:08:17,364 --> 00:08:23,470
“与您共享”会通过属性视图
直观地表示这一点

118
00:08:23,504 --> 00:08:27,908
例如 Enrique 和 Sarah 都分享了

119
00:08:27,941 --> 00:08:31,178
芝加哥前 25 名的播放列表

120
00:08:31,211 --> 00:08:36,984
属性视图显示了他们的联系人头像

121
00:08:37,017 --> 00:08:41,889
点击属性视图会出现一个消歧菜单

122
00:08:41,922 --> 00:08:47,861
允许您选择回复哪条“信息”对话

123
00:08:47,895 --> 00:08:51,064
在设计“与您共享”时
安全性和隐私

124
00:08:51,098 --> 00:08:53,967
是首要考虑和重点

125
00:08:54,001 --> 00:08:58,105
属性视图和消歧视图

126
00:08:58,138 --> 00:09:02,309
是在流程之外代表您绘制的

127
00:09:02,342 --> 00:09:05,279
“与您共享”
会通过通用链接关联

128
00:09:05,312 --> 00:09:08,215
来保护您的 App 内容

129
00:09:08,248 --> 00:09:12,219
因此只有您的 App 有访问权

130
00:09:12,252 --> 00:09:17,958
App 无权访问“信息”收件人和对话

131
00:09:19,426 --> 00:09:22,196
现在您了解了
“与您共享”的工作原理

132
00:09:22,229 --> 00:09:24,131
下面将是最激动人心的部分

133
00:09:24,164 --> 00:09:27,568
如何在您的 App 中使用
“与您共享”

134
00:09:27,601 --> 00:09:31,104
首先 采用通用链接

135
00:09:31,138 --> 00:09:34,441
然后 在 Xcode 的
Capabilities (功能) 标签下

136
00:09:34,474 --> 00:09:37,411
添加新的“与您共享”功能

137
00:09:37,444 --> 00:09:41,682
接着 在您的 App 中放置一个
“与您共享”工具架

138
00:09:41,715 --> 00:09:46,420
并将属性视图添加到您的内容中

139
00:09:46,453 --> 00:09:50,224
我简单地谈谈
通用链接的使用

140
00:09:51,491 --> 00:09:56,730
通用链接允许用户智能地跟踪

141
00:09:56,763 --> 00:09:59,633
App 中的内容或网站的链接

142
00:09:59,666 --> 00:10:03,537
采取以下步骤来支持通用链接

143
00:10:03,570 --> 00:10:06,974
首先在 App 和网站之间

144
00:10:07,007 --> 00:10:10,477
创建双向关联

145
00:10:10,511 --> 00:10:14,715
并指定 App 处理的 URL

146
00:10:14,748 --> 00:10:20,854
您可以通过向 App 添加关联的域权限

147
00:10:20,888 --> 00:10:26,126
并向 Web 服务器
添加 JSON 文件来创建它们

148
00:10:26,159 --> 00:10:28,929
接下来 更新 App 委托

149
00:10:28,962 --> 00:10:32,966
以响应系统在通用链接路由到 App 时

150
00:10:33,000 --> 00:10:36,670
提供的用户活动对象

151
00:10:36,703 --> 00:10:42,409
有关更多信息 请观看视频
“通用链接的新功能”

152
00:10:42,442 --> 00:10:47,614
在 iOS 16 中 我们引入了
一个新的 Shared with You 框架

153
00:10:47,648 --> 00:10:51,752
Shared with You 框架中
有三个主要的类：

154
00:10:51,785 --> 00:10:54,121
SWHighlightCenter

155
00:10:54,154 --> 00:10:59,026
SWHighlight 和 SWAttributionView

156
00:10:59,059 --> 00:11:03,497
SWHighlightCenter 是一个类
能帮助您获取 App 中的

157
00:11:03,530 --> 00:11:04,831
“与您共享”内容

158
00:11:04,865 --> 00:11:10,204
SWHighlight 是一个模型对象
用于包装 App 的共享内容

159
00:11:10,237 --> 00:11:15,042
SWAttributionView
则是一个视图

160
00:11:15,075 --> 00:11:17,778
可帮助将内容连接回
“消息”的会话

161
00:11:17,811 --> 00:11:20,547
并显示属性信息

162
00:11:21,949 --> 00:11:25,953
Hihghlight center 是一个简单的对象
它由以下部分组成

163
00:11:25,986 --> 00:11:31,358
Highlights 是
SWHighlight 对象的数组

164
00:11:31,391 --> 00:11:35,462
还是一个委托属性
当“与您共享”

165
00:11:35,495 --> 00:11:41,768
添加、删除或更新内容时
App 会得到通知

166
00:11:41,802 --> 00:11:46,373
Highlight
是通过 SWHighlight 类来显示的

167
00:11:46,406 --> 00:11:52,513
它用于传递在“信息”中共享的
App 内容的 URL

168
00:11:52,546 --> 00:11:57,317
您可以使用它来引用您的内容
呈现丰富的预览

169
00:11:57,351 --> 00:12:01,021
以及导航到您的 App 中的内容

170
00:12:01,054 --> 00:12:05,726
我将向您演示如何在 App 中
列举“与您共享”的内容

171
00:12:06,994 --> 00:12:12,299
首先 创建一个
SWHighlightCenter 的实例

172
00:12:12,332 --> 00:12:16,670
然后设置委托属性

173
00:12:16,703 --> 00:12:22,109
执行
SWHighlightCenterDelegate 方法

174
00:12:22,142 --> 00:12:24,811
使用 hightlight center 的
highlight 属性

175
00:12:24,845 --> 00:12:29,149
来访问
App 中的“与您共享”内容

176
00:12:29,183 --> 00:12:32,786
App 可以选择保留之前的
highlight 列表

177
00:12:32,819 --> 00:12:37,491
以便快速地将该列表
与最新列表区别开来

178
00:12:39,193 --> 00:12:44,464
使用每个 highlight 显示的 URL 属性

179
00:12:44,498 --> 00:12:47,634
来生成 App 内容的丰富预览

180
00:12:47,668 --> 00:12:53,674
在您的 App 中列举
“与您共享”的内容就是这么简单

181
00:12:53,707 --> 00:12:59,012
接下来 我将向您展示
如何为 App 中的“与您共享”内容

182
00:12:59,046 --> 00:13:01,548
添加和自定义属性视图

183
00:13:01,582 --> 00:13:07,254
SWAttributionView 视图
用于显示内容共享者的

184
00:13:07,287 --> 00:13:10,090
姓名和头像

185
00:13:10,123 --> 00:13:14,595
每个 highlight 都有相应的属性视图

186
00:13:14,628 --> 00:13:17,831
在属性视图上设置 highlight 属性

187
00:13:17,865 --> 00:13:22,102
会触发属性信息的进程外呈现

188
00:13:23,604 --> 00:13:28,275
指定属性视图可以接受的最大宽度

189
00:13:28,308 --> 00:13:34,281
属性视图将根据需要填充或调整空间

190
00:13:34,314 --> 00:13:39,853
在最大空间内设置
属性视图的对齐方式

191
00:13:39,887 --> 00:13:41,321
我们来看一个例子

192
00:13:42,923 --> 00:13:46,693
创建 SWAttributionView 实例

193
00:13:46,727 --> 00:13:49,897
并设置 highlight 属性

194
00:13:49,930 --> 00:13:52,699
设置 preferredMaxLayoutWidth

195
00:13:52,733 --> 00:13:57,905
在本例中
它跨越了共享内容缩略图的底部

196
00:13:57,938 --> 00:14:00,507
约束此视图的宽度锚点

197
00:14:00,541 --> 00:14:05,879
或设置其框架宽度
以控制其内容的最大宽度

198
00:14:05,913 --> 00:14:09,950
根据需要使用 UIView 上的
minimumContentSizeCategory

199
00:14:09,983 --> 00:14:13,153
或 maximumContentSizeCategory 属性

200
00:14:13,187 --> 00:14:18,392
设置视图的最大 AX 内容大小类别

201
00:14:18,425 --> 00:14:22,162
在此视图周围提供足够的垂直空间

202
00:14:22,196 --> 00:14:26,166
视图的高度取决于
preferredContentSizeCategory

203
00:14:26,200 --> 00:14:28,836
和生成的字体大小

204
00:14:28,869 --> 00:14:32,306
如果视图高度受到不必要的约束

205
00:14:32,339 --> 00:14:36,310
那么视图可能会被剪裁或无法绘制

206
00:14:36,343 --> 00:14:40,747
在这种情况下
horizontalAlignment 设置为 Leading

207
00:14:40,781 --> 00:14:44,084
也可以设置为 Center

208
00:14:44,117 --> 00:14:46,887
或 Trailing

209
00:14:46,920 --> 00:14:51,725
接下来 我将向您展示如何
自定义属性视图

210
00:14:51,758 --> 00:14:54,561
设置显示情景有助于

211
00:14:54,595 --> 00:14:58,866
通知系统用户如何使用属性化内容

212
00:14:58,899 --> 00:15:03,303
它还会影响 App 中
“与您共享”的内容排名

213
00:15:03,337 --> 00:15:06,106
在将其添加到窗口之前进行设置

214
00:15:06,139 --> 00:15:10,077
属性视图的背景样式可以根据

215
00:15:10,110 --> 00:15:14,615
内容的背景进行自定义

216
00:15:14,648 --> 00:15:17,284
我们来看一个例子

217
00:15:17,317 --> 00:15:22,990
displayContext 属性的
默认值是 summary

218
00:15:23,023 --> 00:15:28,762
这表示正在显示内容以供使用

219
00:15:28,795 --> 00:15:31,198
当用户主动使用内容时

220
00:15:31,231 --> 00:15:34,401
如看电影或听播客时

221
00:15:34,434 --> 00:15:39,173
可将 displayContext 设置为 detail

222
00:15:39,206 --> 00:15:43,510
设置 displayContext 是
您的 App 可以提供的反馈

223
00:15:43,544 --> 00:15:47,548
这将帮助 Siri 建议为
App 的内容进行排名

224
00:15:47,581 --> 00:15:51,385
将属性视图放置在单色背景上时

225
00:15:51,418 --> 00:15:55,355
应将属性视图的背景样式
设置为“Color”

226
00:15:55,389 --> 00:15:57,558
如本例所示

227
00:15:57,591 --> 00:16:03,964
在多色背景上放置属性视图时
使用材质

228
00:16:03,997 --> 00:16:08,669
这将为视图内容设置材质背景模糊

229
00:16:08,702 --> 00:16:14,041
在本例中 Safari 浏览器的登录页面
有一个背景图像

230
00:16:14,074 --> 00:16:17,611
通过设置正确的背景样式

231
00:16:17,644 --> 00:16:21,582
属性视图的内容更加清晰可见

232
00:16:21,615 --> 00:16:26,086
接下来 我将向您展示如何将
“与您共享”的上下文菜单

233
00:16:26,119 --> 00:16:30,324
添加到 App 内容中 并自定义标题

234
00:16:30,357 --> 00:16:34,127
App 内容附带的现有上下文菜单

235
00:16:34,161 --> 00:16:39,032
可通过属性视图的菜单进行补充

236
00:16:39,066 --> 00:16:42,669
此菜单应与它所扩展的上下文菜单

237
00:16:42,703 --> 00:16:48,175
内联或在其末尾添加

238
00:16:48,208 --> 00:16:53,814
可以为“移除”上下文菜单选项
提供自定义标题

239
00:16:53,847 --> 00:16:59,052
字符串应包含单词 Remove (移除)
并正确本地化

240
00:16:59,086 --> 00:17:04,391
在本例中 Safari 浏览器
在其内容的上下文菜单的末尾

241
00:17:04,424 --> 00:17:08,762
将此菜单标题自定义为
Remove Link (移除)

242
00:17:08,795 --> 00:17:12,533
我将向您展示
如何做到这一点

243
00:17:12,566 --> 00:17:16,036
首先 创建属性视图的实例

244
00:17:16,069 --> 00:17:18,505
并设置 highlight 属性

245
00:17:18,539 --> 00:17:21,975
通过 menuTitleForHideAction

246
00:17:22,009 --> 00:17:24,945
为“移除”上下文菜单
提供自定义标题

247
00:17:24,978 --> 00:17:28,081
配置内容的上下文菜单时

248
00:17:28,115 --> 00:17:34,188
请通过 supplementalMenu 属性
从属性视图获取菜单

249
00:17:34,221 --> 00:17:38,692
然后 将它们附加到
内容的上下文菜单中

250
00:17:38,725 --> 00:17:43,363
这些简单的步骤 可以让您的 App

251
00:17:43,397 --> 00:17:49,336
将属性视图上的上下文菜单选项
添加到内容的上下文菜单中

252
00:17:49,369 --> 00:17:54,508
现在 您了解了在 App 中
使用“与您共享”的一切内容

253
00:17:54,541 --> 00:17:59,680
我们回顾一下在 App 中使用
“与您共享”的三个简单步骤

254
00:17:59,713 --> 00:18:01,849
使用通用链接

255
00:18:01,882 --> 00:18:07,354
然后在 Xcode 中添加
新的“与您共享”功能

256
00:18:07,387 --> 00:18:11,625
导入并使用新的
Shared with You 框架

257
00:18:11,658 --> 00:18:15,462
希望您能在“信息”中共享内容

258
00:18:15,495 --> 00:18:18,498
并在您的 App 中
使用“与您共享”

259
00:18:18,532 --> 00:18:21,869
感谢您的时间和关注

